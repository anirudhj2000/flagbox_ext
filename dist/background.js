chrome.runtime.onMessage.addListener((function(e,o,n){console.log("Taking screenshot message recieved1",e),"take_screenshot"===e.type&&(console.log("Taking screenshot message recieved2",e),chrome.tabs.captureVisibleTab(null,{format:"png"},(function(e){console.log("screenshotUrl",e);var o=atob(e.split(",")[1]);console.log("screenshotUrl1",e,o);var n,s,r=e.split(",")[0].split(":")[1].split(";")[0];console.log("screenshotUrl2",e,r);for(var t=new ArrayBuffer(o.length),l=new Uint8Array(t),c=0;c<o.length;c++)l[c]=o.charCodeAt(c);n=new Blob([t],{type:r}),s=URL.createObjectURL(n),chrome.downloads.download({url:s,filename:"screenshot.png"},(function(e){URL.revokeObjectURL(s)}))})))}));